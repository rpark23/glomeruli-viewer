(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7310:e=>{"use strict";e.exports=require("url")},585:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>g,tree:()=>c});var a=t(7096),r=t(6132),l=t(7284),i=t.n(l),n=t(2564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let c=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3982)),"/Users/rpark/Desktop/daneshjou/projects/glomeruli/web/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,5345)),"/Users/rpark/Desktop/daneshjou/projects/glomeruli/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/rpark/Desktop/daneshjou/projects/glomeruli/web/app/page.tsx"],m="/page",x={require:t,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2300:(e,s,t)=>{Promise.resolve().then(t.bind(t,4201))},4201:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>Home});var a=t(784),r=t(9885),l=t(9518),i=t(7720),n=t(3488);function ImageViewer({images:e,onImageSelect:s}){let[t,o]=(0,r.useState)(""),[c,d]=(0,r.useState)("grid"),m=e.filter(e=>e.filename.toLowerCase().includes(t.toLowerCase())),getImageLabel=e=>{let s=e.replace(".jpg",""),t=s.split("_");if(t.length>=7){let e=t[0];"HE"===e&&(e="H&E");let s=t[4],a=t[6];return`${e} Slide ${s} ROI ${a}`}return s};return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 items-center justify-between",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[a.jsx(l.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),a.jsx("input",{type:"text",placeholder:"Search images...",value:t,onChange:e=>o(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>d("grid"),className:`p-2 rounded-lg ${"grid"===c?"bg-blue-500 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,children:a.jsx(i.Z,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>d("list"),className:`p-2 rounded-lg ${"list"===c?"bg-blue-500 text-white":"bg-gray-200 text-gray-600 hover:bg-gray-300"}`,children:a.jsx(n.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"mb-4 text-sm text-gray-600",children:["Showing ",m.length," of ",e.length," images"]}),"grid"===c?a.jsx("div",{className:"image-grid",children:m.map(e=>(0,a.jsxs)("div",{className:"image-item",onClick:()=>s(e),children:[a.jsx("img",{src:e.url,alt:e.filename,loading:"lazy",className:"w-full h-40 object-cover"}),a.jsx("div",{className:"image-label",children:getImageLabel(e.filename)})]},e.filename))}):a.jsx("div",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("div",{className:"flex items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer",onClick:()=>s(e),children:[a.jsx("img",{src:e.url,alt:e.filename,className:"w-16 h-16 object-cover rounded-lg"}),(0,a.jsxs)("div",{className:"ml-4 flex-1",children:[a.jsx("h3",{className:"font-medium text-gray-900",children:getImageLabel(e.filename)}),a.jsx("p",{className:"text-sm text-gray-500",children:e.filename})]}),a.jsx("div",{className:"text-sm text-gray-400",children:"Click to view"})]},e.filename))}),0===m.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx("div",{className:"text-gray-500 text-lg",children:"No images found"}),a.jsx("div",{className:"text-gray-400 text-sm mt-2",children:"Try adjusting your search terms"})]})]})}var o=t(3250),c=t(8626),d=t(6206),m=t(1910),x=t(1922);function FullPageViewer({image:e,images:s,onClose:t,onImageChange:l}){let[i,n]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!1),[b,j]=(0,r.useState)(!1),[f,v]=(0,r.useState)(.6),w=s.findIndex(s=>s.filename===e.filename),y=(0,r.useCallback)(()=>{w>0&&l(s[w-1])},[w,s,l]),N=(0,r.useCallback)(()=>{w<s.length-1&&l(s[w+1])},[w,s,l]);return(0,r.useEffect)(()=>{let handleKeyDown=e=>{switch(e.key){case"Escape":t();break;case"ArrowLeft":y();break;case"ArrowRight":N();break;case"m":case"M":n(!i)}};return window.addEventListener("keydown",handleKeyDown),()=>window.removeEventListener("keydown",handleKeyDown)},[t,y,N,i]),(0,r.useEffect)(()=>{h(!1),p(!1),j(!1)},[e.filename]),(0,a.jsxs)("div",{className:"fullpage-viewer",children:[(0,a.jsxs)("div",{className:"viewer-header",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:(e=>{let s=e.replace(".jpg",""),t=s.split("_");if(t.length>=7){let e=t[0],s=t[4],a=t[6];return`${e} Slide ${s} ROI ${a}`}return s})(e.filename)}),(0,a.jsxs)("span",{className:"text-sm text-gray-300",children:[w+1," of ",s.length]})]}),(0,a.jsxs)("div",{className:"controls",children:[i&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-white text-sm",children:"Opacity:"}),a.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:f,onChange:e=>v(parseFloat(e.target.value)),className:"w-20",title:"Adjust mask opacity"}),(0,a.jsxs)("span",{className:"text-white text-sm w-8",children:[Math.round(100*f),"%"]})]}),(0,a.jsxs)("button",{onClick:()=>n(!i),className:`btn toggle-btn ${i?"active":""} min-w-[120px]`,title:"Toggle mask overlay (M)",children:[i?a.jsx(o.Z,{className:"w-4 h-4"}):a.jsx(c.Z,{className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"whitespace-nowrap",children:[i?"Hide":"Show"," Mask"]})]}),a.jsx("button",{onClick:t,className:"btn btn-secondary",title:"Close viewer (ESC)",children:a.jsx(d.Z,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"viewer-content",children:[w>0&&a.jsx("button",{onClick:y,className:"nav-arrow prev",title:"Previous image (←)",children:a.jsx(m.Z,{className:"w-6 h-6"})}),w<s.length-1&&a.jsx("button",{onClick:N,className:"nav-arrow next",title:"Next image (→)",children:a.jsx(x.Z,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{className:"relative max-w-full max-h-full",children:[a.jsx("img",{src:e.url,alt:e.filename,className:"viewer-image",onLoad:()=>h(!0)}),!g&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx("div",{className:"text-white",children:"Loading..."})}),i&&(0,a.jsxs)("div",{className:"mask-overlay",children:[b?(0,a.jsxs)("div",{className:"text-white text-center",children:[a.jsx("div",{className:"text-lg font-semibold mb-2",children:"Mask Not Available"}),a.jsx("div",{className:"text-sm opacity-75",children:"No mask found for this image"})]}):a.jsx("img",{src:`/masks/${e.filename}`,alt:"Mask overlay",className:"viewer-image",style:{mixBlendMode:"multiply",opacity:f,position:"absolute",top:0,left:0,pointerEvents:"none"},onLoad:()=>p(!0),onError:()=>j(!0)}),!u&&!b&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx("div",{className:"text-white",children:"Loading mask..."})})]})]})]}),a.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white text-sm opacity-75 text-center",children:(0,a.jsxs)("div",{className:"bg-black bg-opacity-50 px-4 py-2 rounded-lg",children:[a.jsx("div",{children:"Arrow keys: Navigate between images"}),a.jsx("div",{children:"M: Toggle mask • ESC: Close"})]})})]})}function Home(){let[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0),[i,n]=(0,r.useState)(null),[o,c]=(0,r.useState)("all");(0,r.useEffect)(()=>{fetchImages()},[]);let fetchImages=async()=>{try{let e=await fetch("/api/images"),t=await e.json();if(t.images){let e=t.images.map(e=>({filename:e,url:`/api/images/${e}`}));s(e)}}catch(e){console.error("Error fetching images:",e)}finally{l(!1)}},d=e.filter(e=>"all"===o||e.filename.startsWith(o)),m=e.filter(e=>e.filename.startsWith("HE")).length,x=e.filter(e=>e.filename.startsWith("PAS")).length;return t?a.jsx("div",{className:"loading",children:a.jsx("div",{children:"Loading images..."})}):(0,a.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[a.jsx("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Glomeruli Dataset Viewer"}),(0,a.jsxs)("p",{className:"mt-2 text-gray-600",children:["Hi Vivek! ",a.jsx("br",{}),a.jsx("br",{}),"These are H&E and PAS stained slides from ",a.jsx("a",{className:"text-blue-500",href:"https://www.nature.com/articles/s41598-024-51651-1",target:"_blank",children:"He et al. (2024)"})," ","that have been labeled with glomeruli masks (green for normal and red for sclerosis). Click on a thumbnail to view a region of interest (ROI) and then you can toggle on and off the mask by clicking the button in the top right corner (or pressing 'M').",a.jsx("br",{}),a.jsx("br",{}),"Happy viewing!",a.jsx("br",{}),"Ryan"]}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-500",children:[e.length," ROIs available"]})]})}),a.jsx("div",{className:"bg-white border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4",children:(0,a.jsxs)("nav",{className:"flex space-x-8",children:[(0,a.jsxs)("button",{onClick:()=>c("all"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"all"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["All ROIs (",e.length,")"]}),(0,a.jsxs)("button",{onClick:()=>c("HE"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"HE"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["H&E ROIs (",m,")"]}),(0,a.jsxs)("button",{onClick:()=>c("PAS"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"PAS"===o?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["PAS ROIs (",x,")"]})]})})}),a.jsx(ImageViewer,{images:d,onImageSelect:e=>{n(e)}}),i&&a.jsx(FullPageViewer,{image:i,images:d,onClose:()=>{n(null)},onImageChange:n})]})}},3982:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>o});var a=t(5153);let r=(0,a.createProxy)(String.raw`/Users/rpark/Desktop/daneshjou/projects/glomeruli/web/app/page.tsx`),{__esModule:l,$$typeof:i}=r,n=r.default,o=n}};var s=require("../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[214,872,253],()=>__webpack_exec__(585));module.exports=t})();